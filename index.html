<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AL AMIN - Fast Emote Sender</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    * { margin:0; padding:0; box-sizing:border-box; }
    body { font-family:'Segoe UI',sans-serif; background:#f0f2f5; color:#333; padding:10px; line-height:1.4; display:flex; justify-content:center; align-items:center; min-height:100vh; }
    
    /* Login Page */
    .login-container { background:#fff; padding:30px; border-radius:12px; box-shadow:0 4px 12px rgba(0,0,0,0.1); text-align:center; width:100%; max-width:360px; }
    .login-title { font-size:1.8em; font-weight:bold; background:linear-gradient(45deg,#ff6b35,#f7931e); -webkit-background-clip:text; -webkit-text-fill-color:transparent; margin-bottom:16px; }
    .login-input { width:100%; padding:12px; margin:12px 0; border:1px solid #ddd; border-radius:8px; font-size:1.2em; font-family: monospace; letter-spacing: 2px; }
    .login-btn { width:100%; padding:12px; background:#3498db; color:#fff; border:none; border-radius:8px; font-weight:bold; cursor:pointer; transition:background 0.2s; }
    .login-btn:hover { background:#2980b9; }
    .error-msg { color:#e74c3c; margin-top:8px; font-weight:bold; display:none; }
    .telegram-login-btn { display:flex; align-items:center; justify-content:center; gap:8px; width:100%; padding:12px; background:#0088cc; color:#fff; text-decoration:none; border-radius:8px; font-weight:bold; margin-top:12px; transition:0.2s; }
    .telegram-login-btn:hover { background:#006699; }

    /* Main Page */
    .main-container { display:none; width:100%; max-width:800px; }
    .header { text-align:center; margin-bottom:16px; }
    .title { font-size:2.2em; font-weight:bold; background:linear-gradient(45deg,#ff6b35,#f7931e); -webkit-background-clip:text; -webkit-text-fill-color:transparent; margin-bottom:8px; }
    .social-buttons { display:flex; flex-wrap:wrap; gap:8px; justify-content:center; margin:12px 0; }
    .btn { padding:10px 16px; border-radius:20px; color:#fff; text-decoration:none; font-weight:bold; display:flex; align-items:center; gap:6px; font-size:0.9em; transition:0.2s; }
    .btn.telegram { background:#0088cc; }
    .btn.youtube { background:#ff0000; }
    .btn.facebook { background:#1877f2; }
    .btn.solo { background:#e91e63; }
    .btn:hover { transform:scale(1.03); }

    .tab-container { display:flex; justify-content:center; gap:8px; margin:16px 0; }
    .tab-btn { padding:10px 20px; background:#eee; border:none; border-radius:8px; font-weight:bold; cursor:pointer; font-size:0.9em; transition:0.2s; }
    .tab-btn.active { background:#3498db; color:#fff; }

    .form-section { background:#fff; padding:16px; border-radius:12px; box-shadow:0 3px 10px rgba(0,0,0,0.08); margin-bottom:16px; }
    .input-group { margin-bottom:10px; }
    .input-group label { display:block; margin-bottom:4px; font-weight:600; color:#444; font-size:0.9em; }
    .input-group input { width:100%; padding:10px; border:1px solid #ddd; border-radius:8px; font-size:0.95em; }
    .result-section { margin:16px 0; }
    .result-section h3 { margin-bottom:8px; color:#444; font-size:1em; }
    .result-box { padding:12px; border-radius:10px; font-weight:bold; text-align:center; background:#2c3e50; color:#fff; font-size:0.9em; }
    .result-box.success { background:#27ae60; }
    .result-box.error { background:#e74c3c; }

    .emote-grid { display:grid; grid-template-columns:repeat(auto-fill,minmax(120px,1fr)); gap:12px; }
    .emote-card { background:#fff; border-radius:12px; padding:10px; text-align:center; box-shadow:0 2px 8px rgba(0,0,0,0.08); transition:transform 0.2s; }
    .emote-card:hover { transform:translateY(-3px); }
    .emote-card img { width:60px; height:60px; object-fit:contain; margin-bottom:6px; border-radius:6px; }
    .emote-name { font-weight:bold; color:#333; font-size:0.8em; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
    .emote-id { color:#777; font-size:0.7em; margin:3px 0; }
    .send-btn { width:100%; padding:8px; background:#3498db; color:#fff; border:none; border-radius:8px; font-weight:bold; cursor:pointer; font-size:0.8em; transition:0.2s; }
    .send-btn:hover { background:#2980b9; }
    .send-btn:disabled { background:#95a5a6; cursor:not-allowed; }

    .logout-btn { position:fixed; top:12px; right:12px; background:#e74c3c; color:#fff; padding:8px 12px; border-radius:50px; font-weight:bold; cursor:pointer; font-size:0.8em; z-index:1000; }

    @media (max-width:600px) { 
      .social-buttons, .tab-container { flex-direction:column; align-items:center; }
      .emote-grid { grid-template-columns:repeat(auto-fill,minmax(100px,1fr)); }
    }
  </style>
</head>
<body>

  <!-- Login Page -->
  <div id="loginPage" class="login-container">
    <h1 class="login-title">AL AMIN EMOTE SERVER</h1>
    <input 
      type="text" 
      id="passwordInput" 
      class="login-input" 
      placeholder="Enter Password" 
      inputmode="text" 
      autocomplete="off" 
      style="font-family: monospace; font-size: 1.2em; letter-spacing: 2px;"
    />
    <button id="loginBtn" class="login-btn">Login</button>
    <p id="errorMsg" class="error-msg">Wrong Password!</p>
    <a href="https://t.me/alamin_emote_server" target="_blank" class="telegram-login-btn">
      Join Telegram
    </a>
  </div>

  <!-- Main Page -->
  <div id="mainPage" class="main-container">
    <button class="logout-btn" onclick="logout()">Logout</button>

    <header class="header">
      <h1 class="title">AL AMIN EMOTE SERVER</h1>
      <div class="social-buttons">
        <a href="https://t.me/alamin_emote_server" target="_blank" class="btn telegram">Join Telegram</a>
        <a href="#" target="_blank" class="btn youtube">YouTube</a>
        <a href="#" target="_blank" class="btn facebook">Facebook</a>
        <a href="#" target="_blank" class="btn solo">Solo Bot</a>
      </div>
    </header>

    <div class="tab-container">
      <button id="all-tab" class="tab-btn active">All</button>
      <button id="evo-tab" class="tab-btn">Evo</button>
    </div>

    <section class="form-section">
      <div class="input-group"><label>Team Code:</label><input type="text" id="teamCode" placeholder="Optional"></div>
      <div class="input-group"><label>UID 1:</label><input type="text" id="uid1" placeholder="Required" class="required"></div>
      <div class="input-group"><label>UID 2:</label><input type="text" id="uid2" placeholder="Optional"></div>
      <div class="input-group"><label>UID 3:</label><input type="text" id="uid3" placeholder="Optional"></div>
      <div class="input-group"><label>UID 4:</label><input type="text" id="uid4" placeholder="Optional"></div>
    </section>

    <section class="result-section">
      <h3>Result:</h3>
      <div id="resultBox" class="result-box">Ready to send emote.</div>
    </section>

    <section class="emote-grid" id="grid"></section>
  </div>

  <script>
    const CURRENT_PASSWORD = "alamin123"; // এখানে যেকোনো লম্বা পাসওয়ার্ড দিতে পারো
    const FAST_API_URL = "https://emote-psi.vercel.app/api/fastemote";

    // === PASSWORD MASKING (•••••) BUT SUPPORT LONG WORDS ===
    const pwdInput = document.getElementById('passwordInput');
    let realPassword = '';

    pwdInput.addEventListener('input', function() {
      const input = this.value;
      const clean = input.replace(/[^A-Za-z0-9]/g, ''); 
      realPassword = clean;
      this.value = '•'.repeat(clean.length);
      this.dataset.value = clean;
    });

    pwdInput.addEventListener('focus', function() {
      if (realPassword) {
        this.value = realPassword;
      }
    });

    pwdInput.addEventListener('blur', function() {
      if (realPassword) {
        this.value = '•'.repeat(realPassword.length);
      }
    });

    pwdInput.addEventListener('keypress', function(e) {
      if (e.key === 'Enter') {
        document.getElementById('loginBtn').click();
      }
    });

    // === LOGIN CHECK ===
    document.getElementById('loginBtn').onclick = () => {
      const entered = pwdInput.dataset.value || '';
      if (entered === CURRENT_PASSWORD) {
        document.getElementById('loginPage').style.display = 'none';
        document.getElementById('mainPage').style.display = 'block';
        showTab('all');
      } else {
        const err = document.getElementById('errorMsg');
        err.style.display = 'block';
        setTimeout(() => err.style.display = 'none', 2000);
      }
    };

    function logout() {
      document.getElementById('loginPage').style.display = 'block';
      document.getElementById('mainPage').style.display = 'none';
      pwdInput.value = '';
      realPassword = '';
      pwdInput.dataset.value = '';
    }

    // === Emotes (Remove Duplicates) ===
    const emotes = [ /* ... তোমার সব ইমোট ... */ ].filter((v, i, a) => a.findIndex(t => t.id === v.id) === i);

    // ... বাকি কোড আগের মতোই থাকবে ...
    // (আমি শুধু লগইন অংশ ফিক্স করেছি)

    const grid = document.getElementById('grid');
    let currentList = [];

    function showTab(tab) {
      const allBtn = document.getElementById('all-tab');
      const evoBtn = document.getElementById('evo-tab');
      currentList = tab === 'all' ? emotes : emotes.filter(e => e.name.toLowerCase().includes('evo'));
      allBtn.classList.toggle('active', tab === 'all');
      evoBtn.classList.toggle('active', tab !== 'all');
      grid.innerHTML = '';
      renderChunk(0);
    }

    function renderChunk(start) {
      const chunk = currentList.slice(start, start + 12);
      const fragment = document.createDocumentFragment();
      chunk.forEach(emote => {
        const card = document.createElement('div');
        card.className = 'emote-card';
        card.innerHTML = `
          <img data-src="${emote.img}" alt="${emote.name}" onerror="this.src='https://via.placeholder.com/60/333/fff?text=?'" loading="lazy">
          <div class="emote-name">${emote.name}</div>
          <div class="emote-id">ID: ${emote.id}</div>
          <button class="send-btn" data-id="${emote.id}">Send</button>
        `;
        fragment.appendChild(card);
      });
      grid.appendChild(fragment);
      document.querySelectorAll('img[data-src]').forEach(img => {
        img.src = img.dataset.src;
        img.onload = () => img.removeAttribute('data-src');
      });
      if (start + 12 < currentList.length) {
        requestAnimationFrame(() => renderChunk(start + 12));
      }
    }

    let isSending = false;
    grid.addEventListener('click', async e => {
      if (e.target.classList.contains('send-btn') && !isSending) {
        isSending = true;
        e.target.disabled = true;
        await sendEmote(e.target.dataset.id);
        setTimeout(() => {
          e.target.disabled = false;
          isSending = false;
        }, 2000);
      }
    });

    async function sendEmote(id) {
      const u1 = document.getElementById('uid1').value.trim();
      if (!u1) {
        showResult("UID 1 required!", "error");
        return;
      }

      const params = new URLSearchParams({
        tc: document.getElementById('teamCode').value.trim() || '',
        emote_id: id,
        uid1: u1,
        uid2: document.getElementById('uid2').value.trim() || '',
        uid3: document.getElementById('uid3').value.trim() || '',
        uid4: document.getElementById('uid4').value.trim() || ''
      });

      const url = `${FAST_API_URL}?${params.toString()}`;

      try {
        const controller = new AbortController();
        const timeoutId = setTimeout(() => controller.abort(), 15000);

        const res = await fetch(url, {
          method: "GET",
          headers: {
            "Accept": "application/json",
            "Cache-Control": "no-cache",
            "User-Agent": "Mozilla/5.0 (Linux; Android 10; K) AppleWebKit/537.36"
          },
          signal: controller.signal
        });

        clearTimeout(timeoutId);
        let data = {};
        try { data = await res.json(); } catch { data = { status: "error", message: "Invalid JSON" }; }

        if (res.ok && data.status === "success") {
          showResult(`Sent ${id}!`, "success");
          showNotif("ইমোট পাঠানো হয়েছে!");
        } else {
          showResult(data.message || "Failed to send!", "error");
        }
      } catch (err) {
        showResult(err.name === 'AbortError' ? "Timeout! Try again." : "Network error!", "error");
      }
    }

    function showResult(msg, type) {
      const box = document.getElementById('resultBox');
      box.textContent = msg;
      box.className = `result-box ${type}`;
    }

    function showNotif(msg) {
      const n = document.createElement('div');
      n.textContent = msg;
      n.style.cssText = 'position:fixed;bottom:16px;right:16px;background:#27ae60;color:#fff;padding:10px 20px;border-radius:50px;font-weight:bold;z-index:10000;opacity:0;transition:0.3s';
      document.body.appendChild(n);
      setTimeout(() => n.style.opacity = '1', 50);
      setTimeout(() => { n.style.opacity = '0'; setTimeout(() => n.remove(), 300); }, 1800);
    }

    document.getElementById('all-tab').onclick = () => showTab('all');
    document.getElementById('evo-tab').onclick = () => showTab('evo');
  </script>
</body>
</html>
